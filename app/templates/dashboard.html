<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-View Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        .stat-card {
            transition: transform 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .status-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4" x-data="dashboardApp()">
        <!-- Ìó§Îçî -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <h1>üìä A-View Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú</h1>
                    <div>
                        <span class="badge bg-info me-2">ÏÑúÎ≤Ñ ÏãúÍ∞Ñ: <span x-text="currentTime"></span></span>
                        <button class="btn btn-sm btn-outline-primary" @click="refreshData">
                            üîÑ ÏÉàÎ°úÍ≥†Ïπ®
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏãúÏä§ÌÖú ÏÉÅÌÉú -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <h6 class="text-muted">Redis ÏÉÅÌÉú</h6>
                        <div class="d-flex align-items-center">
                            <span class="status-badge badge" 
                                  :class="systemStatus.redis ? 'bg-success' : 'bg-danger'">
                                <span x-text="systemStatus.redis ? '‚úì Ïó∞Í≤∞Îê®' : '‚úó Ïó∞Í≤∞ ÏïàÎê®'"></span>
                            </span>
                        </div>
                        <small class="text-muted" x-show="systemStatus.redis">
                            Î©îÎ™®Î¶¨: <span x-text="systemStatus.redisMemory"></span>MB
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <h6 class="text-muted">SQLite DB</h6>
                        <div class="d-flex align-items-center">
                            <span class="badge bg-success">‚úì Ï†ïÏÉÅ</span>
                        </div>
                        <small class="text-muted">
                            ÌÅ¨Í∏∞: <span x-text="systemStatus.dbSize"></span>MB
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <h6 class="text-muted">LibreOffice</h6>
                        <div class="d-flex align-items-center">
                            <span class="badge" 
                                  :class="systemStatus.libreOffice ? 'bg-success' : 'bg-warning'">
                                <span x-text="systemStatus.libreOffice ? '‚úì ÏÇ¨Ïö©Í∞ÄÎä•' : '‚ö† ÌôïÏù∏ÌïÑÏöî'"></span>
                            </span>
                        </div>
                        <small class="text-muted" x-text="systemStatus.libreVersion"></small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body">
                        <h6 class="text-muted">Ï∫êÏãú ÎîîÎ†âÌÜ†Î¶¨</h6>
                        <div class="d-flex align-items-center">
                            <span class="badge bg-info">
                                <span x-text="systemStatus.cacheFiles"></span> ÌååÏùº
                            </span>
                        </div>
                        <small class="text-muted">
                            Ïö©Îüâ: <span x-text="systemStatus.cacheSize"></span>MB
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Í∏∞Í∞Ñ ÏÑ†ÌÉù Î∞è ÌïÑÌÑ∞ -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <label class="form-label">ÌÜµÍ≥Ñ Í∏∞Í∞Ñ</label>
                        <select class="form-select" x-model="period" @change="loadStats()">
                            <option value="today">Ïò§Îäò</option>
                            <option value="7">ÏµúÍ∑º 7Ïùº</option>
                            <option value="30">ÏµúÍ∑º 30Ïùº</option>
                            <option value="90">ÏµúÍ∑º 90Ïùº</option>
                            <option value="custom">Í∏∞Í∞Ñ ÏßÄÏ†ï</option>
                        </select>
                        <div x-show="period === 'custom'" class="mt-2">
                            <input type="date" class="form-control mb-2" x-model="customStart">
                            <input type="date" class="form-control" x-model="customEnd">
                            <button class="btn btn-sm btn-primary mt-2" @click="loadStats()">Ï°∞Ìöå</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <label class="form-label">Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</label>
                        <div class="btn-group w-100">
                            <button class="btn btn-outline-primary" @click="exportData('json')">
                                üìÑ JSON
                            </button>
                            <button class="btn btn-outline-success" @click="exportData('csv')">
                                üìä CSV
                            </button>
                            <button class="btn btn-outline-danger" @click="exportData('pdf')">
                                üìë PDF Î¶¨Ìè¨Ìä∏
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <label class="form-label">ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ®</label>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" x-model="autoRefresh" @change="toggleAutoRefresh()">
                            <label class="form-check-label">
                                <span x-text="autoRefresh ? 'ÌôúÏÑ±Ìôî (30Ï¥à)' : 'ÎπÑÌôúÏÑ±Ìôî'"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï£ºÏöî ÏßÄÌëú -->
        <div class="row mb-4">
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">Ï¥ù Î≥ÄÌôòÏàò</h6>
                        <h3 class="text-primary" x-text="formatNumber(stats.total_conversions || 0)"></h3>
                        <small :class="stats.trend_conversions > 0 ? 'text-success' : 'text-danger'">
                            <span x-text="stats.trend_conversions > 0 ? '‚Üë' : '‚Üì'"></span>
                            <span x-text="Math.abs(stats.trend_conversions || 0)"></span>%
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">Ï∫êÏãú Ï†ÅÏ§ëÎ•†</h6>
                        <h3 class="text-success" x-text="(stats.cache_hit_rate || 0).toFixed(1) + '%'"></h3>
                        <div class="progress" style="height: 5px;">
                            <div class="progress-bar bg-success" :style="`width: ${stats.cache_hit_rate}%`"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">ÌèâÍ∑† Î≥ÄÌôòÏãúÍ∞Ñ</h6>
                        <h3 class="text-info" x-text="(stats.avg_conversion_time || 0).toFixed(2) + 's'"></h3>
                        <small class="text-muted">
                            ÏµúÎåÄ: <span x-text="(stats.max_conversion_time || 0).toFixed(2)"></span>s
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">Ï≤òÎ¶¨ Ïö©Îüâ</h6>
                        <h3 class="text-warning" x-text="formatSize(stats.total_size_mb || 0)"></h3>
                        <small class="text-muted">
                            ÌèâÍ∑†: <span x-text="formatSize(stats.avg_size_mb || 0)"></span>
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">Í≥†Ïú† ÌååÏùºÏàò</h6>
                        <h3 class="text-secondary" x-text="formatNumber(stats.unique_files || 0)"></h3>
                        <small class="text-muted">
                            Ïû¨ÏÇ¨Ïö©: <span x-text="stats.reuse_rate || 0"></span>%
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center stat-card">
                    <div class="card-body">
                        <h6 class="text-muted mb-2">ÏóêÎü¨Ïú®</h6>
                        <h3 :class="(stats.error_rate || 0) > 5 ? 'text-danger' : 'text-success'" 
                            x-text="(stats.error_rate || 0).toFixed(2) + '%'"></h3>
                        <small class="text-muted">
                            <span x-text="stats.error_count || 0"></span> Í±¥
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï∞®Ìä∏ ÏòÅÏó≠ -->
        <div class="row mb-4">
            <!-- ÏãúÍ≥ÑÏó¥ Ï∞®Ìä∏ -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between">
                        <h5>ÏùºÎ≥Ñ Î≥ÄÌôò Ï∂îÏù¥</h5>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-secondary" 
                                    :class="chartView === 'count' ? 'active' : ''"
                                    @click="switchChartView('count')">Í±¥Ïàò</button>
                            <button class="btn btn-outline-secondary"
                                    :class="chartView === 'size' ? 'active' : ''"
                                    @click="switchChartView('size')">Ïö©Îüâ</button>
                            <button class="btn btn-outline-secondary"
                                    :class="chartView === 'time' ? 'active' : ''"
                                    @click="switchChartView('time')">ÏãúÍ∞Ñ</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="dailyTrendChart" height="100"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- ÌååÏùº ÌÉÄÏûÖ Î∂ÑÌè¨ -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5>ÌååÏùº ÌÉÄÏûÖÎ≥Ñ Î∂ÑÌè¨</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="fileTypeChart"></canvas>
                        <div class="mt-3" style="max-height: 200px; overflow-y: auto;">
                            <template x-for="(type, index) in Object.entries(stats.file_types || {})" :key="type[0]">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span class="badge" :style="`background-color: ${getColor(index)}`">
                                        <span x-text="type[0]"></span>
                                    </span>
                                    <small>
                                        <span x-text="type[1].count"></span> Í±¥
                                        (<span x-text="formatSize(type[1].size_mb)"></span>)
                                    </small>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï∂îÍ∞Ä Ï∞®Ìä∏ -->
        <div class="row mb-4">
            <!-- ÏãúÍ∞ÑÎåÄÎ≥Ñ Î∂ÑÌè¨ -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>ÏãúÍ∞ÑÎåÄÎ≥Ñ ÏÇ¨Ïö© Ìå®ÌÑ¥</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Ï∂úÎ†• ÌòïÏãù ÎπÑÍµê -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Î≥ÄÌôò ÌòïÏãù ÎπÑÍµê (PDF vs HTML)</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="outputFormatChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÌÖåÏù¥Î∏î ÏòÅÏó≠ -->
        <div class="row mb-4">
            <!-- TOP 10 ÌååÏùº -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header d-flex justify-content-between">
                        <h5>ÏûêÏ£º Î≥ÄÌôòÎêú ÌååÏùº TOP 10</h5>
                        <button class="btn btn-sm btn-outline-secondary" @click="loadTopFiles()">Í∞±Ïã†</button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm table-hover">
                                <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="50%">ÌååÏùºÎ™Ö</th>
                                        <th width="15%">ÌÉÄÏûÖ</th>
                                        <th width="15%">ÌöüÏàò</th>
                                        <th width="15%">ÏµúÍ∑º</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template x-for="(file, index) in stats.top_files" :key="file.source_value">
                                        <tr>
                                            <td x-text="index + 1"></td>
                                            <td class="text-truncate" style="max-width: 200px" 
                                                :title="file.file_name">
                                                <small x-text="file.file_name || file.source_value"></small>
                                            </td>
                                            <td>
                                                <span class="badge bg-secondary" x-text="file.file_type"></span>
                                            </td>
                                            <td>
                                                <span class="badge bg-primary" x-text="file.conversion_count"></span>
                                            </td>
                                            <td>
                                                <small x-text="formatTime(file.last_converted)"></small>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÏµúÍ∑º ÏóêÎü¨ -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header d-flex justify-content-between">
                        <h5>ÏµúÍ∑º ÏóêÎü¨ Î°úÍ∑∏</h5>
                        <span class="badge bg-danger" x-text="(stats.errors || []).length"></span>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm table-hover">
                                <thead>
                                    <tr>
                                        <th width="20%">ÏãúÍ∞Ñ</th>
                                        <th width="15%">ÌÉÄÏûÖ</th>
                                        <th width="50%">ÏóêÎü¨</th>
                                        <th width="15%">ÌöüÏàò</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template x-for="error in stats.errors" :key="error.date + error.error_message">
                                        <tr>
                                            <td>
                                                <small x-text="formatTime(error.date)"></small>
                                            </td>
                                            <td>
                                                <span class="badge bg-warning text-dark" x-text="error.file_type || 'N/A'"></span>
                                            </td>
                                            <td class="text-truncate" style="max-width: 200px" 
                                                :title="error.error_message">
                                                <small x-text="error.error_message"></small>
                                            </td>
                                            <td>
                                                <span class="badge bg-danger" x-text="error.count"></span>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï∫êÏãú Ìö®Ïú®ÏÑ± & ÏãúÏä§ÌÖú Ï†ïÎ≥¥ -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Ï∫êÏãú Ìö®Ïú®ÏÑ± Î∂ÑÏÑù</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Ï∫êÏãú Ï†ÅÏ§ë ÌöüÏàò:</strong>
                            </div>
                            <div class="col-6">
                                <span class="badge bg-success" x-text="formatNumber(stats.cache_effectiveness?.cache_hits || 0)"></span>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Ï†àÏïΩÎêú Î≥ÄÌôò ÏãúÍ∞Ñ:</strong>
                            </div>
                            <div class="col-6">
                                <span x-text="formatDuration(stats.cache_effectiveness?.time_saved || 0)"></span>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>Ï†àÏïΩÎêú ÎåÄÏó≠Ìè≠:</strong>
                            </div>
                            <div class="col-6">
                                <span x-text="formatSize(stats.cache_effectiveness?.bandwidth_saved_mb || 0)"></span>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <strong>ÏòàÏÉÅ ÎπÑÏö© Ï†àÍ∞ê:</strong>
                            </div>
                            <div class="col-6">
                                <span class="text-success">
                                    ‚Ç©<span x-text="formatNumber(calculateCostSaving())"></span>
                                </span>
                            </div>
                        </div>
                        
                        <div class="progress" style="height: 30px;">
                            <div class="progress-bar bg-gradient" 
                                 :class="getCacheRateClass()"
                                 :style="`width: ${stats.cache_effectiveness?.hit_rate || 0}%`">
                                <strong x-text="`Ï∫êÏãú Ï†ÅÏ§ëÎ•†: ${(stats.cache_effectiveness?.hit_rate || 0).toFixed(1)}%`"></strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>ÏãúÏä§ÌÖú Î¶¨ÏÜåÏä§</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label>ÎîîÏä§ÌÅ¨ ÏÇ¨Ïö©Îüâ</label>
                            <div class="progress">
                                <div class="progress-bar" :style="`width: ${systemStatus.diskUsage}%`">
                                    <span x-text="`${systemStatus.diskUsage}%`"></span>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>Ï∫êÏãú Î©îÎ™®Î¶¨</label>
                            <div class="progress">
                                <div class="progress-bar bg-info" :style="`width: ${systemStatus.cacheUsage}%`">
                                    <span x-text="`${systemStatus.cacheUsage}%`"></span>
                                </div>
                            </div>
                        </div>
                        <div class="text-end mt-3">
                            <button class="btn btn-sm btn-warning" @click="cleanupCache()">
                                üßπ Ï∫êÏãú Ï†ïÎ¶¨
                            </button>
                            <button class="btn btn-sm btn-danger" @click="cleanupOldData()">
                                üóëÔ∏è Ïò§ÎûòÎêú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    function dashboardApp() {
        return {
            period: '7',
            customStart: '',
            customEnd: '',
            chartView: 'count',
            autoRefresh: false,
            autoRefreshInterval: null,
            currentTime: '',
            stats: {},
            systemStatus: {
                redis: false,
                libreOffice: true,
                dbSize: 0,
                cacheFiles: 0,
                cacheSize: 0,
                diskUsage: 0,
                cacheUsage: 0
            },
            charts: {},
            
            async init() {
                this.updateTime();
                setInterval(() => this.updateTime(), 1000);
                
                await this.loadSystemStatus();
                await this.loadStats();
                this.initCharts();
            },
            
            updateTime() {
                this.currentTime = new Date().toLocaleString('ko-KR');
            },
            
            async loadSystemStatus() {
                try {
                    const response = await fetch('/stats/system-status');
                    const data = await response.json();
                    this.systemStatus = data;
                } catch (error) {
                    console.error('ÏãúÏä§ÌÖú ÏÉÅÌÉú Î°úÎìú Ïã§Ìå®:', error);
                    // ÏóêÎü¨ Ïãú Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
                    this.systemStatus = {
                        redis: false,
                        redisMemory: 0,
                        libreOffice: false,
                        libreVersion: 'Unknown',
                        cacheFiles: 0,
                        cacheSize: 0,
                        dbSize: 0
                    };
                }
            },
            
            async loadStats() {
                try {
                    let url = `/stats/dashboard?days=${this.period}`;
                    if (this.period === 'custom' && this.customStart && this.customEnd) {
                        url = `/stats/dashboard?start_date=${this.customStart}&end_date=${this.customEnd}`;
                    } else if (this.period === 'today') {
                        url = '/stats/dashboard?days=1';
                    }
                    
                    const response = await fetch(url);
                    this.stats = await response.json();
                    this.updateCharts();
                } catch (error) {
                    console.error('ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®:', error);
                }
            },
            
            initCharts() {
                // ÏùºÎ≥Ñ Ï∂îÏù¥ Ï∞®Ìä∏
                this.charts.daily = new Chart(document.getElementById('dailyTrendChart'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Î≥ÄÌôò Í±¥Ïàò',
                            data: [],
                            borderColor: '#36A2EB',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            tension: 0.3
                        }, {
                            label: 'Ï∫êÏãú Ï†ÅÏ§ë',
                            data: [],
                            borderColor: '#4BC0C0',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            tension: 0.3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' }
                        },
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
                
                // ÌååÏùº ÌÉÄÏûÖ Ï∞®Ìä∏
                this.charts.fileType = new Chart(document.getElementById('fileTypeChart'), {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                                '#9966FF', '#FF9F40', '#FF6B6B', '#C9CBCF'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
                
                // ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï∞®Ìä∏
                this.charts.hourly = new Chart(document.getElementById('hourlyChart'), {
                    type: 'bar',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${i}Ïãú`),
                        datasets: [{
                            label: 'Î≥ÄÌôò ÌöüÏàò',
                            data: [],
                            backgroundColor: 'rgba(54, 162, 235, 0.5)',
                            borderColor: '#36A2EB',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
                
                // Ï∂úÎ†• ÌòïÏãù Ï∞®Ìä∏
                this.charts.outputFormat = new Chart(document.getElementById('outputFormatChart'), {
                    type: 'bar',
                    data: {
                        labels: ['PDF', 'HTML'],
                        datasets: [{
                            label: 'Î≥ÄÌôò Í±¥Ïàò',
                            data: [],
                            backgroundColor: ['#FF6384', '#36A2EB']
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
            },
            
            updateCharts() {
                // ÌååÏùº ÌÉÄÏûÖ Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                if (this.stats.file_types) {
                    const types = Object.keys(this.stats.file_types);
                    const counts = types.map(t => this.stats.file_types[t].count);
                    
                    this.charts.fileType.data.labels = types;
                    this.charts.fileType.data.datasets[0].data = counts;
                    this.charts.fileType.update();
                }
                
                // ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                if (this.stats.hourly_distribution) {
                    const hourlyData = Array(24).fill(0);
                    Object.entries(this.stats.hourly_distribution).forEach(([hour, count]) => {
                        hourlyData[parseInt(hour)] = count;
                    });
                    
                    this.charts.hourly.data.datasets[0].data = hourlyData;
                    this.charts.hourly.update();
                }
                
                // Ï∂úÎ†• ÌòïÏãù Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                if (this.stats.output_formats) {
                    this.charts.outputFormat.data.datasets[0].data = [
                        this.stats.output_formats.pdf || 0,
                        this.stats.output_formats.html || 0
                    ];
                    this.charts.outputFormat.update();
                }
            },
            
            switchChartView(view) {
                this.chartView = view;
                // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Ï†ÑÌôò Î°úÏßÅ
            },
            
            toggleAutoRefresh() {
                if (this.autoRefresh) {
                    this.autoRefreshInterval = setInterval(() => {
                        this.refreshData();
                    }, 30000);
                } else {
                    clearInterval(this.autoRefreshInterval);
                }
            },
            
            async refreshData() {
                await this.loadSystemStatus();
                await this.loadStats();
            },
            
            async loadTopFiles() {
                // TOP ÌååÏùº Î™©Î°ù Í∞±Ïã†
                await this.loadStats();
            },